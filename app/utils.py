#File containing the function called by the views

import json
import requests as req

from app import app

from datetime import datetime

#TO DELETE
mock_result = {'cod': '200', 'list': [{'main': {'temp_min': 289.35, 'humidity': 100, 'pressure': 1035.84, 'temp_max': 290.259, 'temp': 289.35, 'sea_level': 1036.54, 'grnd_level': 1035.84, 'temp_kf': -0.91}, 'dt': 1533114000, 'wind': {'deg': 359.501, 'speed': 2.86}, 'dt_txt': '2018-08-01 09:00:00', 'clouds': {'all': 20}, 'weather': [{'icon': '02d', 'description': 'few clouds', 'id': 801, 'main': 'Clouds'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 290.83, 'humidity': 97, 'pressure': 1035.32, 'temp_max': 291.516, 'temp': 290.83, 'sea_level': 1036, 'grnd_level': 1035.32, 'temp_kf': -0.68}, 'dt': 1533124800, 'wind': {'deg': 291.008, 'speed': 2.45}, 'dt_txt': '2018-08-01 12:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 291.79, 'humidity': 92, 'pressure': 1034.93, 'temp_max': 292.243, 'temp': 291.79, 'sea_level': 1035.51, 'grnd_level': 1034.93, 'temp_kf': -0.45}, 'dt': 1533135600, 'wind': {'deg': 282.502, 'speed': 4.97}, 'dt_txt': '2018-08-01 15:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 292.4, 'humidity': 90, 'pressure': 1034.32, 'temp_max': 292.626, 'temp': 292.4, 'sea_level': 1034.93, 'grnd_level': 1034.32, 'temp_kf': -0.23}, 'dt': 1533146400, 'wind': {'deg': 288.002, 'speed': 5.92}, 'dt_txt': '2018-08-01 18:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 292.562, 'humidity': 89, 'pressure': 1034.42, 'temp_max': 292.562, 'temp': 292.562, 'sea_level': 1035.27, 'grnd_level': 1034.42, 'temp_kf': 0}, 'dt': 1533157200, 'wind': {'deg': 294.001, 'speed': 5.91}, 'dt_txt': '2018-08-01 21:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 292.192, 'humidity': 91, 'pressure': 1034.75, 'temp_max': 292.192, 'temp': 292.192, 'sea_level': 1035.53, 'grnd_level': 1034.75, 'temp_kf': 0}, 'dt': 1533168000, 'wind': {'deg': 1.50055, 'speed': 5.38}, 'dt_txt': '2018-08-02 00:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 290.914, 'humidity': 98, 'pressure': 1034.63, 'temp_max': 290.914, 'temp': 290.914, 'sea_level': 1035.48, 'grnd_level': 1034.63, 'temp_kf': 0}, 'dt': 1533178800, 'wind': {'deg': 37.5052, 'speed': 7.51}, 'dt_txt': '2018-08-02 03:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 290.815, 'humidity': 99, 'pressure': 1035.24, 'temp_max': 290.815, 'temp': 290.815, 'sea_level': 1036.05, 'grnd_level': 1035.24, 'temp_kf': 0}, 'dt': 1533189600, 'wind': {'deg': 44.0018, 'speed': 7.21}, 'dt_txt': '2018-08-02 06:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 292.985, 'humidity': 87, 'pressure': 1035.83, 'temp_max': 292.985, 'temp': 292.985, 'sea_level': 1036.56, 'grnd_level': 1035.83, 'temp_kf': 0}, 'dt': 1533200400, 'wind': {'deg': 46.5005, 'speed': 5.12}, 'dt_txt': '2018-08-02 09:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 294.9, 'humidity': 80, 'pressure': 1035.16, 'temp_max': 294.9, 'temp': 294.9, 'sea_level': 1035.89, 'grnd_level': 1035.16, 'temp_kf': 0}, 'dt': 1533211200, 'wind': {'deg': 45.5011, 'speed': 2.51}, 'dt_txt': '2018-08-02 12:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 295.07, 'humidity': 79, 'pressure': 1034.32, 'temp_max': 295.07, 'temp': 295.07, 'sea_level': 1034.93, 'grnd_level': 1034.32, 'temp_kf': 0}, 'dt': 1533222000, 'wind': {'deg': 343.504, 'speed': 0.42}, 'dt_txt': '2018-08-02 15:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 295.907, 'humidity': 75, 'pressure': 1033.43, 'temp_max': 295.907, 'temp': 295.907, 'sea_level': 1034.19, 'grnd_level': 1033.43, 'temp_kf': 0}, 'dt': 1533232800, 'wind': {'deg': 298.501, 'speed': 1.85}, 'dt_txt': '2018-08-02 18:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 296.424, 'humidity': 73, 'pressure': 1033.88, 'temp_max': 296.424, 'temp': 296.424, 'sea_level': 1034.73, 'grnd_level': 1033.88, 'temp_kf': 0}, 'dt': 1533243600, 'wind': {'deg': 4.50302, 'speed': 3.72}, 'dt_txt': '2018-08-02 21:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 294.496, 'humidity': 81, 'pressure': 1034.33, 'temp_max': 294.496, 'temp': 294.496, 'sea_level': 1035.11, 'grnd_level': 1034.33, 'temp_kf': 0}, 'dt': 1533254400, 'wind': {'deg': 28.5003, 'speed': 7.55}, 'dt_txt': '2018-08-03 00:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 293.261, 'humidity': 87, 'pressure': 1034.02, 'temp_max': 293.261, 'temp': 293.261, 'sea_level': 1034.8, 'grnd_level': 1034.02, 'temp_kf': 0}, 'dt': 1533265200, 'wind': {'deg': 35.5003, 'speed': 7.33}, 'dt_txt': '2018-08-03 03:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 293.106, 'humidity': 87, 'pressure': 1034.13, 'temp_max': 293.106, 'temp': 293.106, 'sea_level': 1034.93, 'grnd_level': 1034.13, 'temp_kf': 0}, 'dt': 1533276000, 'wind': {'deg': 54.5013, 'speed': 6.91}, 'dt_txt': '2018-08-03 06:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 295.366, 'humidity': 77, 'pressure': 1034.53, 'temp_max': 295.366, 'temp': 295.366, 'sea_level': 1035.42, 'grnd_level': 1034.53, 'temp_kf': 0}, 'dt': 1533286800, 'wind': {'deg': 65.0037, 'speed': 4.76}, 'dt_txt': '2018-08-03 09:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 296.014, 'humidity': 75, 'pressure': 1034.3, 'temp_max': 296.014, 'temp': 296.014, 'sea_level': 1035.05, 'grnd_level': 1034.3, 'temp_kf': 0}, 'dt': 1533297600, 'wind': {'deg': 83.0045, 'speed': 1.71}, 'dt_txt': '2018-08-03 12:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.034, 'humidity': 72, 'pressure': 1033.58, 'temp_max': 297.034, 'temp': 297.034, 'sea_level': 1034.2, 'grnd_level': 1033.58, 'temp_kf': 0}, 'dt': 1533308400, 'wind': {'deg': 260.501, 'speed': 2.22}, 'dt_txt': '2018-08-03 15:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.644, 'humidity': 70, 'pressure': 1033.01, 'temp_max': 297.644, 'temp': 297.644, 'sea_level': 1033.64, 'grnd_level': 1033.01, 'temp_kf': 0}, 'dt': 1533319200, 'wind': {'deg': 291.501, 'speed': 5.82}, 'dt_txt': '2018-08-03 18:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.215, 'humidity': 71, 'pressure': 1033.28, 'temp_max': 297.215, 'temp': 297.215, 'sea_level': 1034.04, 'grnd_level': 1033.28, 'temp_kf': 0}, 'dt': 1533330000, 'wind': {'deg': 299.504, 'speed': 5.5}, 'dt_txt': '2018-08-03 21:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 296.109, 'humidity': 75, 'pressure': 1033.72, 'temp_max': 296.109, 'temp': 296.109, 'sea_level': 1034.58, 'grnd_level': 1033.72, 'temp_kf': 0}, 'dt': 1533340800, 'wind': {'deg': 28.0058, 'speed': 6.61}, 'dt_txt': '2018-08-04 00:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 294.707, 'humidity': 80, 'pressure': 1033.58, 'temp_max': 294.707, 'temp': 294.707, 'sea_level': 1034.38, 'grnd_level': 1033.58, 'temp_kf': 0}, 'dt': 1533351600, 'wind': {'deg': 34.0013, 'speed': 6.17}, 'dt_txt': '2018-08-04 03:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 293.761, 'humidity': 85, 'pressure': 1034, 'temp_max': 293.761, 'temp': 293.761, 'sea_level': 1034.74, 'grnd_level': 1034, 'temp_kf': 0}, 'dt': 1533362400, 'wind': {'deg': 39.0046, 'speed': 6.12}, 'dt_txt': '2018-08-04 06:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 296.088, 'humidity': 75, 'pressure': 1034.46, 'temp_max': 296.088, 'temp': 296.088, 'sea_level': 1035.25, 'grnd_level': 1034.46, 'temp_kf': 0}, 'dt': 1533373200, 'wind': {'deg': 27.0057, 'speed': 4.57}, 'dt_txt': '2018-08-04 09:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.368, 'humidity': 71, 'pressure': 1034.36, 'temp_max': 297.368, 'temp': 297.368, 'sea_level': 1035.08, 'grnd_level': 1034.36, 'temp_kf': 0}, 'dt': 1533384000, 'wind': {'deg': 22.0018, 'speed': 2.37}, 'dt_txt': '2018-08-04 12:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.41, 'humidity': 72, 'pressure': 1033.58, 'temp_max': 297.41, 'temp': 297.41, 'sea_level': 1034.29, 'grnd_level': 1033.58, 'temp_kf': 0}, 'dt': 1533394800, 'wind': {'deg': 285.501, 'speed': 1.51}, 'dt_txt': '2018-08-04 15:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 298.194, 'humidity': 69, 'pressure': 1032.87, 'temp_max': 298.194, 'temp': 298.194, 'sea_level': 1033.6, 'grnd_level': 1032.87, 'temp_kf': 0}, 'dt': 1533405600, 'wind': {'deg': 280.002, 'speed': 3.78}, 'dt_txt': '2018-08-04 18:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.699, 'humidity': 70, 'pressure': 1033.75, 'temp_max': 297.699, 'temp': 297.699, 'sea_level': 1034.54, 'grnd_level': 1033.75, 'temp_kf': 0}, 'dt': 1533416400, 'wind': {'deg': 1.00171, 'speed': 4.82}, 'dt_txt': '2018-08-04 21:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 295.297, 'humidity': 81, 'pressure': 1033.92, 'temp_max': 295.297, 'temp': 295.297, 'sea_level': 1034.74, 'grnd_level': 1033.92, 'temp_kf': 0}, 'dt': 1533427200, 'wind': {'deg': 29.5004, 'speed': 6.92}, 'dt_txt': '2018-08-05 00:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 293.805, 'humidity': 88, 'pressure': 1033.13, 'temp_max': 293.805, 'temp': 293.805, 'sea_level': 1033.96, 'grnd_level': 1033.13, 'temp_kf': 0}, 'dt': 1533438000, 'wind': {'deg': 34.5053, 'speed': 5.86}, 'dt_txt': '2018-08-05 03:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 293.276, 'humidity': 90, 'pressure': 1032.91, 'temp_max': 293.276, 'temp': 293.276, 'sea_level': 1033.72, 'grnd_level': 1032.91, 'temp_kf': 0}, 'dt': 1533448800, 'wind': {'deg': 33.0023, 'speed': 4.9}, 'dt_txt': '2018-08-05 06:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 295.129, 'humidity': 81, 'pressure': 1033.19, 'temp_max': 295.129, 'temp': 295.129, 'sea_level': 1033.92, 'grnd_level': 1033.19, 'temp_kf': 0}, 'dt': 1533459600, 'wind': {'deg': 12.5024, 'speed': 2.67}, 'dt_txt': '2018-08-05 09:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 296.272, 'humidity': 78, 'pressure': 1032.86, 'temp_max': 296.272, 'temp': 296.272, 'sea_level': 1033.54, 'grnd_level': 1032.86, 'temp_kf': 0}, 'dt': 1533470400, 'wind': {'deg': 277, 'speed': 1.92}, 'dt_txt': '2018-08-05 12:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.513, 'humidity': 73, 'pressure': 1031.55, 'temp_max': 297.513, 'temp': 297.513, 'sea_level': 1032.25, 'grnd_level': 1031.55, 'temp_kf': 0}, 'dt': 1533481200, 'wind': {'deg': 273, 'speed': 4.87}, 'dt_txt': '2018-08-05 15:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 297.28, 'humidity': 74, 'pressure': 1030.37, 'temp_max': 297.28, 'temp': 297.28, 'sea_level': 1031.05, 'grnd_level': 1030.37, 'temp_kf': 0}, 'dt': 1533492000, 'wind': {'deg': 282.501, 'speed': 6.08}, 'dt_txt': '2018-08-05 18:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}, {'main': {'temp_min': 296.379, 'humidity': 76, 'pressure': 1030.37, 'temp_max': 296.379, 'temp': 296.379, 'sea_level': 1031.18, 'grnd_level': 1030.37, 'temp_kf': 0}, 'dt': 1533502800, 'wind': {'deg': 295.502, 'speed': 6.22}, 'dt_txt': '2018-08-05 21:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 296.452, 'humidity': 76, 'pressure': 1030.08, 'temp_max': 296.452, 'temp': 296.452, 'sea_level': 1030.93, 'grnd_level': 1030.08, 'temp_kf': 0}, 'dt': 1533513600, 'wind': {'deg': 20.0001, 'speed': 6.36}, 'dt_txt': '2018-08-06 00:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 295.383, 'humidity': 81, 'pressure': 1029.06, 'temp_max': 295.383, 'temp': 295.383, 'sea_level': 1029.86, 'grnd_level': 1029.06, 'temp_kf': 0}, 'dt': 1533524400, 'wind': {'deg': 39.5, 'speed': 5.31}, 'dt_txt': '2018-08-06 03:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01n', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'n'}}, {'main': {'temp_min': 295.273, 'humidity': 81, 'pressure': 1028.71, 'temp_max': 295.273, 'temp': 295.273, 'sea_level': 1029.53, 'grnd_level': 1028.71, 'temp_kf': 0}, 'dt': 1533535200, 'wind': {'deg': 82.0003, 'speed': 6.26}, 'dt_txt': '2018-08-06 06:00:00', 'clouds': {'all': 0}, 'weather': [{'icon': '01d', 'description': 'clear sky', 'id': 800, 'main': 'Clear'}], 'sys': {'pod': 'd'}}], 'message': 0.0026, 'city': {'country': 'FR', 'coord': {'lat': 47.6587, 'lon': -2.76}, 'population': 54020, 'name': 'Vannes', 'id': 2970777}, 'cnt': 40}

#Constant used to convert wind direction
DIRECTION = {1:'N', 2:'NNE', 3:'NE', 4:'ENE', 5:'E', 6:'ESE', 7:'SE', 8:'SSE', 9:'S', 10:'SSW', 11:'SW', 12:'WSW', 13:'W', 14:'WNW', 15:'NW', 16:'NNW', 17:'N'}

####### Function used to get data from differents API

def request_api(url):
    """Request the selected url and return data from the api as json"""
    data = req.get(url)
    return data.json()

def get_meteo_for_city(city):
    """Method to get the meteo data with the api"""
    url = "http://api.openweathermap.org/data/2.5/forecast?q={},fr&mode=json&APPID={}".format(city, app.config['OWM_API_KEY'])  
    meteo = request_api(url)
    # meteo = mock_result #Use for developpment
    list_meteo_day = []
    for element in meteo['list']:
        NewMeteoDay = MeteoDay(element)
        list_meteo_day.append(NewMeteoDay)
    return list_meteo_day



####### Function used to format MeteoDay attributes #######

def convert_direction(direction):
    """Convert degree direction in cardinal direction"""
    number_direction = round(direction/22.5, 0) + 1
    return DIRECTION[number_direction]

def convert_temp(temp_kelvin):
    """Convert kelvin degrees to celsius degrees"""
    temp_celsius = round(temp_kelvin - 273.15)
    return temp_celsius

def convert_wind_speed(speed_ms):
    speed_kts = round(speed_ms/0.514, 0)
    return speed_kts

############################################################


class MeteoDay:
    """Class containing all the meteo informations for a period"""

    def __init__(self, meteo):
        self.date = datetime.strptime(meteo['dt_txt'], '%Y-%m-%d %H:%M:%S')
        self.img = meteo['weather'][0]['icon']
        self.cloud = meteo['clouds']['all']
        self.temp = convert_temp(meteo['main']['temp'])
        self.wind_direction = convert_direction(float(meteo['wind']['deg']))
        self.wind_degree = int(meteo['wind']['deg'])
        self.wind_speed = int(convert_wind_speed(meteo['wind']['speed']))

        #Manages the case where there is no rainy day in the period
        try:
            self.rain = meteo['rain'][0]['3h']
        except KeyError:
            self.rain = 0
